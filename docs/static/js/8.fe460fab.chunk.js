(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[8],{672:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return X}));var c=a(41),r=a(25),n=a(10),l=a(1),i=a.n(l),s=a(14),o=a(104),d=a(27),u=a(86),m=a(33),E=a(24),b=a(40),g=a(129),p=a(349),O=a(350),j=a(43),v=a(19),N=a(343),f=a(634),h=a(633),I=a(664);function P(e){e.payPal;var t=e.successPaymentHandler,a=e.basket;return i.a.createElement(I.a,{createOrder:function(e,t){return t.order.create({purchase_units:[{amount:{value:Number(a.calcTotalPrice).toFixed(2)}}]})},amount:Number(a.calcTotalPrice).toFixed(2),onApprove:t})}var w=a(351),y=a(137),S=a(15),T=["calcTotalPrice","calcTaxPrice","calcShippingPrice","calcItemsPrice","items"],W={NEW:"NEW",new:"NEW",EXISTING:"EXISTING"},x=[{label:"betaal",to:"#cart",el:i.a.createElement(f.a,{sx:{width:25,height:25},src:"/img/send-step-1.png"})},{to:"#shipping",label:"opgestuurd",el:i.a.createElement(f.a,{sx:{width:25,height:25},src:"/img/send-step-3.png"})},{to:"#placeorder",label:"ontvangen",el:i.a.createElement(f.a,{sx:{width:25,height:25},src:"/img/send-step-2.png"})}];function G(){var e=Object(I.c)();return Object(n.a)(e,1)[0].isPending?i.a.createElement(h.a,{sx:{height:200},animation:"wave",variant:"rectangular"}):null}function X(){var e=Object(s.b)(),t=Object(j.h)().id,a=Object(j.f)(),f=Object(l.useState)(1),h=Object(n.a)(f,2),X=h[0],k=h[1],F=Object(l.useState)(W[t||W.NEW]||W.EXISTING),_=Object(n.a)(F,2),D=_[0],z=_[1],A=Object(s.c)((function(e){return e.orderDetails})),H=Object(n.a)(A,2),J=H[0],R=H[1],q=Object(s.c)((function(e){return e.paypal})),B=Object(n.a)(q,3),C=B[0],L=B[1],U=B[2],V=Object(s.c)(S.q.selector).userInfo,K=Object(s.c)((function(e){return e.cart})),M=Object(l.useState)(new y.c(Object(r.a)({},Object.assign(D===W.NEW?K:J.succes?R:{})))),Q=Object(n.a)(M,2),Y=Q[0],Z=Q[1],$=Object(s.c)((function(e){return e.orderPay})),ee=Object(n.a)($,2),te=ee[0],ae=ee[1],ce=Object(s.c)((function(e){return e.orderDeliver})),re=Object(n.a)(ce,2),ne=re[0],le=re[1],ie=Object(s.c)((function(e){return e.orderReceived})),se=Object(n.a)(ie,2),oe=se[0];se[1];Object(l.useEffect)((function(){X?(k(0),e({type:d.x}),e({type:d.m}),e({type:d.p}),e({type:d.c}),V&&e(Object(o.e)()),D===W.NEW||t===W.NEW?(z(W.NEW),Z(new y.c(Object(r.a)({},K)))):D===W.EXISTING&&t&&"new"!==t&&(e(Object(o.d)(t)),z(W.EXISTING),Z(new y.c({})))):ne.success?(e(Object(o.d)(le.order._id)),e({type:d.m}),z(W.EXISTING)):te.success?(Z(new y.c(Object(r.a)({},ae.order))),z(W.EXISTING)):J.success?(Z(new y.c(Object(r.a)({},R))),z(W.EXISTING)):D!==W.EXISTING&&t&&"new"!==t&&(Z(new y.c({})),e(Object(o.d)(t)),z(W.EXISTING))}),[z,X,J.initializing,J.loading,V,e,J.success,J.error,t,te.success,ne.success,R,K,D]);return i.a.createElement(b.a,{loading:te.loading||ne.loading||L||J.loading},i.a.createElement("div",{className:"container g-0"},i.a.createElement("div",{className:"row py-3"},D===W.NEW?i.a.createElement(g.a,{step:3}):i.a.createElement(g.a,{loading:J.loading,steps:x,step:J.success&&R.isPaid?R.isSend?2:1:0})),J.showError?i.a.createElement(E.b,{loading:J.loading,error:R,severity:"error"},R):i.a.createElement("div",{className:"row p-4"},i.a.createElement("div",{className:"col-md-8 col-lg-8 pb-4"},Y._id?i.a.createElement(v.b,{className:"btn-link",to:"/order/"+Y._id},i.a.createElement("h4",null,"Bestelling")):D===W.NEW&&i.a.createElement(i.a.Fragment,null,i.a.createElement(N.a,null),i.a.createElement("br",null)),i.a.createElement("div",null,i.a.createElement(w.a,{order:Y.items})),i.a.createElement("br",null),i.a.createElement(O.a,{cart:Y,loading:te.loading,elevation:1,delivery:!0}),i.a.createElement("br",null),i.a.createElement(O.b,{cart:Y,loading:ne.loading,elevation:1,delivery:!0}),oe.success&&i.a.createElement(i.a.Fragment,null,i.a.createElement("br",null),i.a.createElement(O.c,{cart:Y,loading:oe.loading,elevation:1,delivery:!0}))),i.a.createElement("div",{className:"col-md-4 col-lg-4 order-screen"},i.a.createElement("div",{className:"data-info p-3"},i.a.createElement(p.a,{order:Y})),(D===W.NEW||!(null===Y||void 0===Y?void 0:Y.isPaid))&&(te.showError||L||C?i.a.createElement(E.b,{loading:te.loading||L,error:te.error||C,severity:"error"},ae,C):i.a.createElement(i.a.Fragment,null,i.a.createElement(I.b,{options:{components:"buttons,marks,messages","enable-funding":"sofort,card,credit,ideal",currency:"EUR",locale:"nl_NL",intent:"capture","client-id":U}},i.a.createElement(G,null),i.a.createElement(P,{basket:Y,successPaymentHandler:function(t,n){return n.order.capture().then((function(t){var n=Y.calcTotalPrice,l=Y.calcTaxPrice,i=Y.calcShippingPrice,s=Y.calcItemsPrice,d=Y.items,u=Object(c.a)(Y,T);e(Object(o.a)(a,Object(r.a)(Object(r.a)({},u),{},{itemsPrice:s,shippingPrice:i,taxPrice:l,totalPrice:n,orderItems:d}),t))}))},payPal:U})))),(null===V||void 0===V?void 0:V.isAdmin)&&J.success&&R.isPaid&&!R.isDelivered&&i.a.createElement(i.a.Fragment,null,ne.showError?i.a.createElement(E.b,{loading:ne.loading,error:le,severity:"error"},le):i.a.createElement(u.a,{className:"w-100",variant:"contained",type:"button",onClick:function(){e(Object(o.c)(R._id))},endIcon:i.a.createElement(m.k,{className:"m-l-7","aria-hidden":"true"})},i.a.createElement("span",null,"Verzend order")))))))}}}]);