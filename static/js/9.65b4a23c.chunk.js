(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[9],{670:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return X}));var c=a(41),n=a(24),r=a(10),l=a(1),i=a.n(l),s=a(14),o=a(103),d=a(28),u=a(87),m=a(36),E=a(23),b=a(40),g=a(129),p=a(344),O=a(345),j=a(42),v=a(17),N=a(338),f=a(235),h=a(632),I=a(662);function P(e){e.payPal;var t=e.successPaymentHandler,a=e.basket;return i.a.createElement(I.a,{createOrder:function(e,t){return t.order.create({purchase_units:[{amount:{value:Number(a.calcTotalPrice).toFixed(2)}}]})},amount:Number(a.calcTotalPrice).toFixed(2),onApprove:t})}var w=a(346),y=a(116),S=["calcTotalPrice","calcTaxPrice","calcShippingPrice","calcItemsPrice","items"],T={NEW:"NEW",new:"NEW",EXISTING:"EXISTING"},W=[{label:"betaal",to:"#cart",el:i.a.createElement(f.a,{sx:{width:25,height:25},src:"/img/send-step-1.png"})},{to:"#shipping",label:"opgestuurd",el:i.a.createElement(f.a,{sx:{width:25,height:25},src:"/img/send-step-3.png"})},{to:"#placeorder",label:"ontvangen",el:i.a.createElement(f.a,{sx:{width:25,height:25},src:"/img/send-step-2.png"})}];function G(){var e=Object(I.c)();return Object(r.a)(e,1)[0].isPending?i.a.createElement(h.a,{sx:{height:200},animation:"wave",variant:"rectangular"}):null}function X(){var e=Object(s.b)(),t=Object(j.h)().id,a=Object(j.f)(),f=Object(l.useState)(1),h=Object(r.a)(f,2),X=h[0],x=h[1],k=Object(l.useState)(T[t||T.NEW]||T.EXISTING),F=Object(r.a)(k,2),_=F[0],z=F[1],D=Object(s.c)((function(e){return e.orderDetails})),A=Object(r.a)(D,2),H=A[0],J=A[1],R=Object(s.c)((function(e){return e.paypal})),B=Object(r.a)(R,3),C=B[0],L=B[1],U=B[2],V=Object(s.c)((function(e){return e.userSignin})).userInfo,q=Object(s.c)((function(e){return e.cart})),K=Object(l.useState)(new y.c(Object(n.a)({},Object.assign(_===T.NEW?q:H.succes?J:{})))),M=Object(r.a)(K,2),Q=M[0],Y=M[1],Z=Object(s.c)((function(e){return e.orderPay})),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ae=Object(s.c)((function(e){return e.orderDeliver})),ce=Object(r.a)(ae,2),ne=ce[0],re=ce[1],le=Object(s.c)((function(e){return e.orderReceived})),ie=Object(r.a)(le,2),se=ie[0];ie[1];Object(l.useEffect)((function(){X?(x(0),e({type:d.z}),e({type:d.m}),e({type:d.p}),e({type:d.c}),V&&e(Object(o.e)()),_===T.NEW||t===T.NEW?(z(T.NEW),Y(new y.c(Object(n.a)({},q)))):_===T.EXISTING&&t&&"new"!==t&&(e(Object(o.d)(t)),z(T.EXISTING),Y(new y.c({})))):ne.success?(e(Object(o.d)(re.order._id)),e({type:d.m}),z(T.EXISTING)):ee.success?(Y(new y.c(Object(n.a)({},te.order))),z(T.EXISTING)):H.success?(Y(new y.c(Object(n.a)({},J))),z(T.EXISTING)):_!==T.EXISTING&&t&&"new"!==t&&(Y(new y.c({})),e(Object(o.d)(t)),z(T.EXISTING))}),[z,X,H.initializing,H.loading,V,e,H.success,H.error,t,ee.success,ne.success,J,q,_]);return i.a.createElement(b.a,{loading:ee.loading||ne.loading||L||H.loading},i.a.createElement("div",{className:"container g-0"},i.a.createElement("div",{className:"row py-3"},_===T.NEW?i.a.createElement(g.a,{step:3}):i.a.createElement(g.a,{loading:H.loading,steps:W,step:H.success&&J.isPaid?J.isSend?2:1:0})),H.showError?i.a.createElement(E.b,{loading:H.loading,error:J,severity:"error"},J):i.a.createElement("div",{className:"row p-4"},i.a.createElement("div",{className:"col-md-8 col-lg-8 pb-4"},Q._id?i.a.createElement(v.b,{className:"btn-link",to:"/order/"+Q._id},i.a.createElement("h4",null,"Bestelling")):_===T.NEW&&i.a.createElement(i.a.Fragment,null,i.a.createElement(N.a,null),i.a.createElement("br",null)),i.a.createElement("div",null,i.a.createElement(w.a,{order:Q.items})),i.a.createElement("br",null),i.a.createElement(O.a,{cart:Q,loading:ee.loading,elevation:1,delivery:!0}),i.a.createElement("br",null),i.a.createElement(O.b,{cart:Q,loading:ne.loading,elevation:1,delivery:!0}),se.success&&i.a.createElement(i.a.Fragment,null,i.a.createElement("br",null),i.a.createElement(O.c,{cart:Q,loading:se.loading,elevation:1,delivery:!0}))),i.a.createElement("div",{className:"col-md-4 col-lg-4 order-screen"},i.a.createElement("div",{className:"data-info p-3"},i.a.createElement(p.a,{order:Q})),(_===T.NEW||!(null===Q||void 0===Q?void 0:Q.isPaid))&&(ee.showError||L||C?i.a.createElement(E.b,{loading:ee.loading||L,error:ee.error||C,severity:"error"},te,C):i.a.createElement(i.a.Fragment,null,i.a.createElement(I.b,{options:{components:"buttons,marks,messages","enable-funding":"sofort,card,credit,ideal",currency:"EUR",locale:"nl_NL",intent:"capture","client-id":U}},i.a.createElement(G,null),i.a.createElement(P,{basket:Q,successPaymentHandler:function(t,r){return r.order.capture().then((function(t){var r=Q.calcTotalPrice,l=Q.calcTaxPrice,i=Q.calcShippingPrice,s=Q.calcItemsPrice,d=Q.items,u=Object(c.a)(Q,S);e(Object(o.a)(a,Object(n.a)(Object(n.a)({},u),{},{itemsPrice:s,shippingPrice:i,taxPrice:l,totalPrice:r,orderItems:d}),t))}))},payPal:U})))),(null===V||void 0===V?void 0:V.isAdmin)&&H.success&&J.isPaid&&!J.isDelivered&&i.a.createElement(i.a.Fragment,null,ne.showError?i.a.createElement(E.b,{loading:ne.loading,error:re,severity:"error"},re):i.a.createElement(u.a,{className:"w-100",variant:"contained",type:"button",onClick:function(){e(Object(o.c)(J._id))},endIcon:i.a.createElement(m.h,{className:"m-l-7","aria-hidden":"true"})},i.a.createElement("span",null,"Verzend order")))))))}}}]);